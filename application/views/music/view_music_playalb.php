<?php
class view_music_playalb extends view_music
{
    public $logo= JOINT_SITE_EXEC_DIR."/img/music/albums.png";
    public $shortcut_icon = JOINT_SITE_EXEC_DIR."/img/popimg/music-logo.png";
    public $hasAccessCreate = false;

    function set_head_array()
    {
        parent::set_head_array(); // TODO: Change the autogenerated stub

        $this->lang_map->head["h1"] = "Проиграть альбом ".$this->playAlb["albumAlias"];
        $this->lang_map->head["title"] = $this->playAlb["albumAlias"];

    }

    function print_page_content()
    {
        echo "<div class='contentBlock-frame'><div class='contentBlock-center'>" .
            "<div class='contentBlock-wrap'>".
            "<div class='music-menu'>";

        $this->music_menu();
        echo "</div>";

        echo $this->print_music_album($this->playAlb);

        echo "<div class='ac-wrap'>".
            "<audio controls='controls' autoplay id='htmlMusicPlayer'>".
            "</audio>".
            "</div>".
            "<div class='tracks-list' id='music-album'>";

        if(count($this->trackList) > 0){
            echo "<div class='track-line caption'>".
                "<div class='track-num'>No</div>".
                "<div class='track-artist'>".$this->lang_map->music["t_art"]."</div>".
                "<div class='track-name'>".$this->lang_map->music["t_song"]."</div>".
                "<div class='track-play'>".$this->lang_map->music["t_play"]."</div>".
                "</div>";

            $track_num = 0;

            foreach ($this->trackList as $num=>$track_row){
                $print_track_file = $track_row["track_file"];
                if(strpos(" ".$track_row["track_file"], "http", 0)!=1){
                    $print_track_file=MUSIC_TRACKS_DIR."/".$print_track_file;
                }

                $track_num++;
                echo "<div class='track-line'>".
                    "<div class='track-num'>".$track_num."</div>".
                    "<div class='track-artist'>".$track_row["track_artist"]."</div>".
                    "<div class='track-name'>".
                    "<a href='".$print_track_file."'>".$track_row["track_name"]."</a>".
                    "</div>".
                    "<div class='track-play'><input type='button' value='Play'></div>".
                    "</div>";
            }
        }

        echo "</div>".
            "</div></div></div>";
    }
    function music_menu()
    {
        echo "<div class='music-menu'>";
        $this->music_nav_menu();
        if($this->albumsList){
            echo "<div class='alb-menu'>";
            $list_alb_menu = null;
            $list_alb_first = null;

            foreach ($this->albumsList as $num => $alb_row){

                if($this->playAlb["albumAlias"] == $alb_row["albumAlias"]){
                    $list_alb_first.= "<a href='".JOINT_SITE_EXEC_DIR."/music/album/".$alb_row["albumAlias"]."' class='active'>".$alb_row["albumName"]."</a>";
                }else{
                    $list_alb_menu.= "<a href='".JOINT_SITE_EXEC_DIR."/music/album/".$alb_row["albumAlias"]."'>".$alb_row["albumName"]."</a>";
                }
            }
            echo $list_alb_first.$list_alb_menu."</div>";
        }
        echo "</div>";
    }
}